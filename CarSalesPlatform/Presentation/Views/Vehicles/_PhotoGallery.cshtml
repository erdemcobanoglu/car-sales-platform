@model List<Presentation.ViewModels.Vehicles.VehiclePhotoVm>

@{
    var cover = Model?.FirstOrDefault(p => p.IsCover)?.Url
                ?? Model?.OrderBy(p => p.SortOrder).FirstOrDefault()?.Url
                ?? "https://via.placeholder.com/1200x700?text=No+Photo";
}

<div class="card shadow-sm">
    <div class="card-header bg-white d-flex justify-content-between align-items-center">
        <strong>Photos</strong>
        <span class="text-muted small">@(Model?.Count ?? 0) / 10</span>
    </div>

    <div class="card-body">
        <div class="ratio ratio-16x9 bg-light rounded overflow-hidden">
            <img id="mainPhoto"
                 src="@cover"
                 class="w-100 h-100"
                 style="object-fit: cover;"
                 alt="Vehicle photo" />
        </div>

        @if (Model != null && Model.Any())
        {
            <div class="mt-3 d-flex flex-wrap gap-2">
                @foreach (var p in Model.OrderBy(x => x.SortOrder))
                {
                    <button type="button"
                            class="border-0 p-0 bg-transparent"
                            onclick="setMainPhoto('@p.Url')">
                        <img src="@p.Url"
                             alt="thumb"
                             width="88"
                             height="56"
                             class="rounded border @(p.IsCover ? "border-primary" : "")"
                             style="object-fit: cover;" />
                    </button>
                }
            </div>
        }
        else
        {
            <div class="mt-3 text-muted">No photos yet.</div>
        }
    </div>
</div>

<script>
    function setMainPhoto(url) {
        const el = document.getElementById('mainPhoto');
        if (el) el.src = url;
    }
</script>
